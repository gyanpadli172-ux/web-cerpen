<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Kumpulan Cerpen</title>
<style>
body{font-family:Arial;margin:0;padding:20px;background:#f5f5f5}
.container{max-width:800px;margin:auto;background:white;padding:20px;border-radius:8px}
input,textarea{width:100%;padding:10px;margin:6px 0}
button{padding:10px 16px;margin-top:8px;cursor:pointer}
.cerpen-card{padding:12px;border:1px solid #ccc;border-radius:6px;margin:10px 0;background:white}
.cover{width:100%;max-height:200px;object-fit:cover;border-radius:6px;margin-bottom:10px}
</style>
</head>
<body>

<div class="container">
<h2>Unggah Cerpen</h2>

<input id="nama" placeholder="Nama Penulis">
<input id="judul" placeholder="Judul Cerpen">
<input id="coverUrl" placeholder="Link gambar cover (opsional)">
<input id="deleteCode" placeholder="Kode Khusus (wajib untuk hapus/edit)">
<textarea id="isi" rows="6" placeholder="Tulis cerpen di sini..."></textarea>
<button onclick="simpanCerpen()">Simpan Cerpen</button>

<hr>

<h2>Daftar Cerpen</h2>
<div id="listCerpen"></div>
</div>

<!-- Firebase -->
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>

<script>
// ðŸ”¥ GANTI CONFIG INI DENGAN PUNYAMU
const firebaseConfig = {
  apiKey: "YOUR_KEY",
  authDomain: "YOUR_AUTH",
  projectId: "YOUR_PROJECT_ID",
  storageBucket: "YOUR_BUCKET",
  messagingSenderId: "YOUR_MSG",
  appId: "YOUR_APPID"
};

firebase.initializeApp(firebaseConfig);
const db = firebase.firestore();

// Simpan cerpen
function simpanCerpen(){
  const data = {
    nama: nama.value.trim(),
    judul: judul.value.trim(),
    isi: isi.value.trim(),
    coverUrl: coverUrl.value.trim(),
    deleteCode: deleteCode.value.trim()
  };

  if(!data.nama || !data.judul || !data.isi || !data.deleteCode){
    alert("Harus diisi semua kecuali cover.");
    return;
  }

  db.collection("cerpen").add(data).then(()=>{
    nama.value=""; judul.value=""; isi.value=""; coverUrl.value=""; deleteCode.value="";
  });
}

// Tampilkan cerpen
db.collection("cerpen").onSnapshot(snapshot=>{
  listCerpen.innerHTML = "";
  snapshot.forEach(doc=>{
    const c = doc.data();
    const el = document.createElement("div");
    el.className="cerpen-card";
    el.innerHTML = `
      ${c.coverUrl ? `<img src="${c.coverUrl}" class="cover">` : ""}
      <b>${c.judul}</b><br>
      <i>${c.nama}</i><br><br>
      <button onclick="bacaCerpen('${doc.id}')">Baca</button>
      <button onclick="editCerpen('${doc.id}')">Edit</button>
      <button onclick="hapusCerpen('${doc.id}')">Hapus</button>
    `;
    listCerpen.appendChild(el);
  });
});

// Baca cerpen
function bacaCerpen(id){
  db.collection("cerpen").doc(id).get().then(d=>{
    const c = d.data();
    alert("Judul: "+c.judul+"\n\n"+c.isi);
  });
}

// Edit cerpen (butuh kode)
function editCerpen(id){
  const kode = prompt("Masukkan kode khusus untuk mengedit:");
  if(kode===null) return;

  db.collection("cerpen").doc(id).get().then(d=>{
    const c = d.data();
    if(kode !== c.deleteCode){
      alert("Kode salah!");
      return;
    }

    const newJudul = prompt("Judul baru:", c.judul);
    const newIsi = prompt("Isi baru:", c.isi);

    db.collection("cerpen").doc(id).update({
      judul:newJudul,
      isi:newIsi
    });
  });
}

// Hapus cerpen (butuh kode)
function hapusCerpen(id){
  const kode = prompt("Masukkan kode khusus untuk menghapus:");
  if(kode===null) return;

  db.collection("cerpen").doc(id).get().then(d=>{
    const c = d.data();
    if(kode !== c.deleteCode){
      alert("Kode salah!");
      return;
    }

    db.collection("cerpen").doc(id).delete();
  });
}
</script>

</body>
</html>